{"version":3,"sources":["assets\\script\\hero.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nenum HeroState {\r\n    Stand = 1,\r\n    Attack = 2,\r\n}\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property\r\n    text: string = '英雄脚本';\r\n\r\n    private _speed: number = 200;\r\n    private _sp = new cc.Vec2(0, 0);\r\n    private _input = {};\r\n    private _heroState: HeroState = HeroState.Stand;\r\n    private _anima: string = null;\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n\r\n        this._anima = 'idle';\r\n\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.node.getComponent(cc.Animation).on(cc.Animation.EventType.FINISHED,\r\n            this.animationFinished, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.node.getComponent(cc.Animation).off(cc.Animation.EventType.FINISHED, this.animationFinished, this);\r\n    }\r\n\r\n    onKeyDown(e: any) {\r\n        this._input[e.keyCode] = 1;\r\n    }\r\n\r\n    onKeyUp(e: any) {\r\n        this._input[e.keyCode] = 0;\r\n    }\r\n\r\n    animationFinished(event: string, data: any) {\r\n        if (data.name == 'attack') {\r\n            if (this._anima != 'idle') {\r\n                this._heroState = HeroState.Stand;\r\n                this.setHeroAni('idle');\r\n            }\r\n        }\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    setHeroAni(anima: string) {\r\n        if (this._anima === anima)\r\n            return;\r\n        this._anima = anima;\r\n        this.node.getComponent(cc.Animation).play(this._anima);\r\n    }\r\n\r\n    update(dt: any) {\r\n        let anima = 'idle';\r\n        if (this._input[cc.macro.KEY.j]) {\r\n            this._heroState = HeroState.Attack;\r\n        }\r\n\r\n        switch (this._heroState) {\r\n            case HeroState.Stand:\r\n                let scaleX = Math.abs(this.node.scaleX);\r\n                let lv = this.node.getComponent(cc.RigidBody).linearVelocity;\r\n\r\n                if (this._input[cc.macro.KEY.a] || this._input[cc.macro.KEY.left]) {\r\n                    this._sp.x = -1;\r\n                    if (this.node.scaleX === scaleX) {\r\n                        this.node.scaleX = -scaleX;\r\n                    }\r\n\r\n                } else if (this._input[cc.macro.KEY.d] || this._input[cc.macro.KEY.right]) {\r\n                    this._sp.x = 1;\r\n                    if (this.node.scaleX !== scaleX) {\r\n                        this.node.scaleX = scaleX;\r\n                    }\r\n\r\n                } else {\r\n                    this._sp.x = 0;\r\n                }\r\n\r\n                if (this._sp.x) {\r\n                    lv.x = this._sp.x * this._speed;\r\n                    anima = 'run';\r\n                } else {\r\n                    lv.x = 0;\r\n                    anima = 'idle';\r\n                }\r\n                this.node.getComponent(cc.RigidBody).linearVelocity = lv;\r\n                break\r\n            case HeroState.Attack:\r\n                anima = 'attack';\r\n                console.log('attack');\r\n                break;\r\n        }\r\n\r\n        this.setHeroAni(anima);\r\n\r\n    }\r\n}\r\n"]}